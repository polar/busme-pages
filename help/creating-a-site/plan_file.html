<h1>Anatomy of a Busme! CSV File</h1>
<p>
  You use Busme! CSV Files, that are usually generated from our Journey Builder Tool to populate your
  Deployment and/or Networks with Journeys that will be simulated by our system. Busme! CSV Files may
  define an entire Deployment with multiple networks or just a single Network.
</p>
<p>
  When you get a CSV File back from the Journey Builder it has several lines that may look like the following example:
</p>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    <th>I</th>
    <th>J</th>
    <th>K</th>
    <th>L</th>
  </tr>
  <tr>
    <td>Network</td>
    <td>South Campus</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Route Name</td>
    <td>240</td>
    <td>Nob Hill</td>
    <td>402</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Start Date</td>
    <td>2014-02-14</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>End Date</td>
    <td>2014-05-14</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Exception Dates</td>
    <td>2014-03-06</td>
    <td>2014-03-07</td>
    <td>2014-03-08</td>
    <td>2014-03-09</td>
    <td>2014-03-10</td>
    <td>2014-03-11</td>
    <td>2014-03-12</td>
    <td>2014-03-13</td>
    <td>2014-03-14</td>
    <td>2014-03-15</td>
    <td>2014-03-16</td>
  </tr>
  <tr>
    <td>Direction</td>
    <td>ToSouthCampus</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Stop Points</td>
    <td>Days</td>
    <td>Display Name</td>
    <td>VID</td>
    <td>College Place</td>
    <td>Manley North</td>
    <td>Manley South</td>
    <td>GoldStein Center</td>
    <td>NOTE</td>
    <td>file:nob-hill.kml</td>
    <td></td>
    <td></td>
  </tr>
  </tbody>
</table>
<h2>Understanding the Compiling Process</h2>
<p>
  This file is read from top to bottom. You may describe multiple networks in a single
  deployment, and multiple routes, services, directions, and journeys all in a single CSV file. Normally, you
  will most likely take the approach to consolidate a particular route each into their own files, and furthermore
  a separate file for each direction.
  If you were to generate the Busme! CSV Plan Zip File, It will be organized in such a way.
</p>
<h3>Network</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
  </tr>
  <tr>
    <td>Network</td>
    <td>South Campus</td>
  </tr>
  </tbody>
</table>
<p>
  The network line specifies in which network the next definitions will apply. It must come <em>before</em> any
  Route Name definition. If you are uploading this plan file as a definition for an entire Deployment, this line
  will cause the creation of the network named in column B.
</p>
<p>
  A Network line is optional. If you are planning the entire Deployment, and a Network is not specified,
  the first network in the Deployment, if it exists, will be used. If it does not exist, a Network called
  "DefaultNetwork" is created, and the routes are defined within that network.
</p>
<h3>Route Name</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
  </tr>
  <tr>
    <td>Route Name</td>
    <td>240</td>
    <td>Nob Hill</td>
    <td>402</td>
  </tr>
  </tbody>
</table>
<p>
  The Route Name line specifies a Name in Column C for the Route Code in Column B. Column D contains
  the Route Sort. The Route Code may be any sequence of alphanumeric characters, such as 240, ATA3, etc.
  The Route Sort is a floating point number that specifies how your route will show up when sorted against
  other route codes in your system. For instance, in Syracuse, the bus lines are defined by their last
  two numbers, and the first number is a variation. So, the routes want to be sorted by their last two
  numbers then by their first number, and such the route sort for the 240 is 402. The Route Sort is used
  for internal sorting and does not get displayed. However, so you get the idea, in Syracuse we'd have the
  following sort of bus routes. 140, 240, 340, 440, 443, 543, 144, 244, 344, 50, 255, and this sort governs
  how they are ordered on the Busme! Mobile App and web page.
</p>
<p>
  NOTE: The Route Code is displayed on the Busme! map pages and on the Busme! Map. So, it is prudent to keep it short
  so it doesn't take up too much screen real estate. Also, routes with single digits may not look nice, so a pleasing
  length is 2-4 characters.
</p>
<p>
  If there are subsequent occurrences of Route Name lines for the same Route Code, the last definition
  read will prevail. You're allowed to have them, just make sure they are the same for all files.
</p>
<p>
  The route code is also used by being specified in a Journey line, which is illustrated below.
  A Journey's line may specify route codes that do not match Route Name lines.
  If that is the case, an invisible default Route Name line is created as is as if the Route Name is the route code,
  and its Route Sort number is numeric version of the route code, if the route code is a number, or is zero.
</p>
<h3>Start Date and End Date</h3>
<p>
  These line fields are the are the start date and the end date of the service
  applied to anything below it, until the next Start Data and End Date lines.
  These lines must each appear together in the file, if you specify one,
  you must subsequently specify the other.
</p>
<p>
  NOTE: Dates are interpreted according to the Busme! Transit Sites Date Format Setting.
  For example, say you use a date specification 06/05/2015. If you chose MM/DD/YYYY for the Date Format,
  that date would be June 5, 2015, whereas if you chose DD/MM/YYYY, that date would be May 6, 2015. However,
  if you use the date 2015-06-05, the date will be June 5, 2015 regardless of the Date Format setting.
</p>
<h3>Exception Dates</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    <th>I</th>
    <th>J</th>
    <th>K</th>
    <th>L</th>
  </tr>
  <tr>
    <td>Exception Dates</td>
    <td>2014-03-06</td>
    <td>2014-03-07</td>
    <td>2014-03-08</td>
    <td>2014-03-09</td>
    <td>2014-03-10</td>
    <td>2014-03-11</td>
    <td>2014-03-12</td>
    <td>2014-03-13</td>
    <td>2014-03-14</td>
    <td>2014-03-15</td>
    <td>2014-03-16</td>
  </tr>
  </tbody>
</table>
<p>
  The Exception Dates specified in Column B and beyond will tell that any of the
  Journey specification will not apply within the service date range. You will get
  a warning if one of the exception dates is NOT in between the current Start and End Dates.
</p>
<h3>Direction</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
  </tr>
  <tr>
    <td>Direction</td>
    <td>ToSouthCampus</td>
  </tr>
  </tbody>
</table>
<p>
  In the Direction line, column B specifies a one (or two) word designation in which direction
  the next journeys that are specified are traveling. Please keep it short as this element is
  displayed to distinguish journeys in the list of journeys.
  Examples, are Inbound, Outbound, Downtown, etc. A Direction must be specified immediately before a
  Stop Points line.
</p>
<h3>Stop Points</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    <th>I</th>
    <th>J</th>
  </tr>
  <tr>
    <td>Stop Points</td>
    <td>Days</td>
    <td>Display Name</td>
    <td>VID</td>
    <td>College Place</td>
    <td>Manley North</td>
    <td>Manley South</td>
    <td>GoldStein Center</td>
    <td>NOTE</td>
    <td>file:nob-hill.kml</td>
  </tr>
  </tbody>
</table>
<p>
  The Stop Points line is where the stop points or timing points are specified. The names of
  each Stop Point start in Column E and continue until NOTE appears. In the column after NOTE,
  the KML file that specifies the default Journey Pattern for this direction of the Route. The
  names that comprise the list of Stop Points must occur in the KML file in the order they
  are shown, otherwise, an error will occur. This reason is why we generate the CSV file
  for you, It correctly matches the KML file.
</p>
<p>
  If the KML is larger than 8K characters, the KML may reside in a separate file. When it is this
  case, a file url will be in its place, as shown above. When processing the Busme! CSV compiler
  will look for that file in the current folder, and keep looking upwards though containing folders
  until a match is found.
</p>
<p>
  If a Planner is astutely aware as to this processing, the Planner can drastically reduce the
  size by sharing a KML file. The Planner may also share a KML file because it only contains the Journey Pattern
  that may be reused for many different service files. Note, however, that the KML file contains the Stop Point
  names as well, and they must match the Stop Points line in any CSV file it is used.
</p>
<p>
  The Journey Pattern referred to in the column after NOTE appears is the <em>default</em> Journey
  Pattern. Lines subsequent to the Stop Point lines will place times underneath the Stop Point
  names, and in the column after NOTE appears, one can place another KML structure or KML file
  reference. The reason you would place a KML in this column is that the Journey Pattern may
  have been altered slightly for a particular journey, such as bypassing a street on the particular
  run,
</p>
<h3>Journey Line Specifications</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    <th>I</th>
    <th>J</th>
  </tr>
  <tr>
    <td>Stop Points</td>
    <td>Days</td>
    <td>Display Name</td>
    <td>VID</td>
    <td>College Place</td>
    <td>Manley North</td>
    <td>Manley South</td>
    <td>GoldStein Center</td>
    <td>Note</td>
    <td>file:nob-hill.kml</td>
  </tr>
  <tr>
    <td>240</td>
    <td>MTWRFS</td>
    <td>Nob Hill</td>
    <td></td>
    <td>07:30 AM</td>
    <td>07:40 AM</td>
    <td>07:41 AM</td>
    <td>07:50 AM</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>240</td>
    <td>MTWRFS</td>
    <td>Nob Hill</td>
    <td></td>
    <td>08:30 AM</td>
    <td>08:40 AM</td>
    <td>08:41 AM</td>
    <td>08:50 AM</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>240</td>
    <td>SN</td>
    <td>Nob Hill</td>
    <td></td>
    <td>08:31 AM</td>
    <td>08:41 AM</td>
    <td>08:42 AM</td>
    <td>08:51 AM</td>
    <td>3</td>
    <td></td>
  </tr>
  </tbody>
</table>
<p>
  Each Line that follows a Direction and Stop Points line and has a Route Code in Column A is a
  Journey Definition. Column B contains the Day Class, which is a mix of the following codes:
</p>
<div class="row-fluid">
  <table class="offset2 span3 table table-bordered">
    <tbody>
    <tr>
      <th>M</th>
      <td>Monday</td>
    </tr>
    <tr>
      <th>T</th>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>W</th>
      <td>Wednesday</td>
    </tr>
    <tr>
      <th>R</th>
      <td>Thursday</td>
    </tr>
    <tr>
      <th>F</th>
      <td>Friday</td>
    </tr>
    <tr>
      <th>S</th>
      <td>Saturday</td>
    </tr>
    <tr>
      <th>N</th>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>K</th>
      <td>MTWRF</td>
    </tr>
    <tr>
      <th>E</th>
      <td>SN</td>
    </tr>
    <tr>
      <th>D</th>
      <td>MTWRFSN</td>
    </tr>
    </tbody>
  </table>

</div>
<p>
  You may notice in the above example that some lines have different day designations. The first
  two do not run on Sunday, but the last run only runs on Saturday and Sunday.
</p>
<p>
  Column C contains the Display Name of the Journey. This name may be displayed on the bus for
  passengers to identify the bus. Some route numbers may have different display names, due to
  direction, variation in route, etc. This field will be displayed on the "Routes List" navigator selector on the
  Busme! Mobile App and website.
</p>
<p>
  Column D contains the VID, which is short for Vehicle Identification Number. You may fill this out
  if it gives a passenger or driver some better way of identifying the particular bus for the journey.
  If it is there, it will be displayed when a passenger or driver is trying to select the bus on which he
  or she is to report.
</p>
<p>
  Column E and all the way up to the Column where NOTE appears are to contain time specifications.
  The issue of {{ cms:bus:page:link /help/times, 'time representation' }} may be a complex one,
  and it contains its own {{ cms:bus:page:link /help/times, 'help section' }}.
  In each column under a Stop Point, you fill out the time in which the bus leaves or arrives
  at the particular stop point. Some cells may be left empty. See below.
</p>
<h3>Alternate Journey Patterns</h3>
<table class="table table-bordered">
  <tbody>
  <tr>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
    <th>F</th>
    <th>G</th>
    <th>H</th>
    <th>I</th>
    <th>J</th>
  </tr>
  <tr>
    <td>Stop Points</td>
    <td>Days</td>
    <td>Display Name</td>
    <td>VID</td>
    <td>College Place</td>
    <td>Manley North</td>
    <td>Manley South</td>
    <td>GoldStein Center</td>
    <td>Note</td>
    <td>file:nob-hill.kml</td>
  </tr>
  <tr>
    <td>240</td>
    <td>SN</td>
    <td>Nob Hill</td>
    <td></td>
    <td>08:31 AM</td>
    <td></td>
    <td></td>
    <td>08:51 AM</td>
    <td>3</td>
    <td>file:nob-hill-skip-manley.kml</td>
  </tr>
  <tr>
    <td>240</td>
    <td>MTWRFS</td>
    <td>Nob Hill</td>
    <td></td>
    <td></td>
    <td>07:40 AM</td>
    <td>07:41 AM</td>
    <td>07:50 AM</td>
    <td></td>
    <td></td>
  </tr>
  </tbody>
</table>
<p>
  The Journey Pattern referred to in the column after NOTE appears in the Stop Points line
  is the <em>default</em> Journey
  Pattern. Lines subsequent to the Stop Point line will place times underneath the Stop Point
  names. In the column after NOTE appears, one can place another KML structure or KML file
  reference. The reason you would place a KML in this column is that the Journey Pattern may
  have been altered slightly for a particular journey, such as bypassing a street on the particular
  run or bypassing a Stop Point. The above example shows that the first journey specified does not have any times listed
  in the Columns for Manley North and Manley South and the Journey Pattern is a different
  KML file reference noting a different Journey Pattern, with possibly a different path.
  In this case, each Stop Point name for which a time is specified must be in the KML file specified,
  and in the specified order, or an error will occur.
</p>
<p>
  Other situations can state that times at the beginning and the end of the Stop Points maybe left
  out such as the in the last journey in the above example. This case shows no time in the College
  Place Stop Point, however it is using the Default Journey Pattern, which presumably has the
  College Place Stop Point in it. In this case, the Journey completely skips College Place, and is
  specified to Start at Manley North. Times may be left off the end of a Journey Specification and
  the journey will end at the Stop Point in which the last time was specified.
</p>
<h2>The Busme! CSV Plan Zip File</h2>
<p>
  You must upload a single file for processing into a Deployment or Network. Since, you may have
  many CSV files describing multiple routes and in conjunction with multiple KML files and place
  them into a folder, we ask you to Zip up the folder.
</p>
<p>
  This process does two things. It consolidates an
  entire folder structure into a single file, which makes uploading or downloading simple. Secondly,
  it compresses the file to almost a tenth of its original size, which makes the upload/download
  process more efficient.
</p>
<h3>Folder Structure of a Busme! CSV Plan</h3>
<p>
  The folder structure of a Busme! CSV Plan may be arbitrary. However, there is a logic to its
  processing.
</p>
<p>
  First off, the Busme! CSV compiler only looks for files with the ".csv" suffix. Files that
  end in ".xls" (for MS Excell) or ".ods" (for LibreOffice/StarOffice) are ignored. Even if
  a file is indeed a CSV file, if it does not have the ".csv" suffix, it will not be
  processed.
</p>
<h3>Embedded Zip Files</h3>
<p>
  One may zip up a folder containing a particular network (make sure that all the CSV files
  in that folder have a Network Line). Being that it is cumbersome to unzip that file into
  another folder, one can just place Zip files inside the folder before zipping that folder.
  The Busme! CSV Compiler will unzip all files with ".zip" suffixes in place. Therefore, you
  may define an entire Deployment by placing all the zipped Network Folders into a Folder, and
  zipping that for upload.
</p>
<p>
  For example, The folder Network_1 may have the following Busme! contents:
</p>

<ul>
  <li>Folder: Network_1
    <ul>
      <li>Folder: Route_240
        <ul>
          <li>Route_240_Service_1.csv</li>
          <li>Route_240_Service_2.csv</li>
          <li>Route_240_Service_1.kml</li>
          <li>Route_240_Service_2.kml</li>
        </ul>
      <li>Folder: Route_240C
        <ul>
          <li>Route_240C_Service_1.csv</li>
          <li>Route_240C_Service_1.kml</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>
  This folder is then zipped up into "Network_1.zip". Then,
  we may copy it into a folder called "Deployment_1" with
  another folder "Network_2".
</p>
<ul>
  <li>Folder: Deployment_1
    <ul>
      <li>File: Network_1.zip</li>
      <li>Folder: Network_2
        <ul>
          <li>Folder: Route_350
            <ul>
              <li>Route_350_Service_1.csv</li>
              <li>Route_350_Service_2.csv</li>
              <li>Route_350_Service_1.kml</li>
              <li>Route_350_Service_2.kml</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>
  And then, zip up the "Deployment_1" folder into "Deployment_1.zip" and upload that file
  to the Busme! CSV Plan processor.
</p>
<h3>Folder Structure of a Generated Busme! CSV Plan</h3>
<p>
  If you choose to use our tool to generate a Busme! CSV Plan from our internal representation
  it will not come out in the same organization with which you sent it in. <strong>We do not save your file.</strong>
  We process it into our internal data storage, and get rid of the file. We do that, because you
  may make limited changes to the data. Some of those changes may be in the geographic path
  between two Stop Points, which would change the KML used for certain journeys.
</p>
<p>
  The structure follows this basic structure which you may imply from network "Network_1" that
  contains two routes that have Route Codes of 240 and 240C, and network "Network_2" that contains route
  with the Route Code of 350:
</p>
<ul>
  <li>Folder: Deployment_1
    <ul>
      <li>Folder: Network_1
        <ul>
          <li>Folder: Route_240
            <ul>
              <li>Route_240_Service_1.csv</li>
              <li>Route_240_Service_2.csv</li>
              <li>Route_240_Service_1.kml</li>
              <li>Route_240_Service_2.kml</li>
            </ul>
          <li>Folder: Route_240C
            <ul>
              <li>Route_240C_Service_1.csv</li>
              <li>Route_240C_Service_1.kml</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Folder: Network_2
        <ul>
          <li>Folder: Route_350
            <ul>
              <li>Route_350_Service_1.csv</li>
              <li>Route_350_Service_2.csv</li>
              <li>Route_350_Service_1.kml</li>
              <li>Route_350_Service_2.kml</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<h3>Example Zip of a Busme! Plan Folder</h3>
<p>
  The following link holds an example Busme! Plan Folder for a Deployment, containing Folders for each particular
  Network, a for folder for each Route within each Network. The Route folders contain the ODS files containing
  different files for different directions and services for that particular Route. This example will give you
  a limited illustration of what is possible, and how things are constructed.

  The most illustrative part is the use of TIME(h,m,s) equations to fill in the schedule Stop Point times.
</p>
<p>
  <a href="https://objects.dreamhost.com:443/busme-prod-files/examples/SyracuseUnivsersity.zip">SyracuseUniversity.zip</a>
</p>
<p>
  It also gives you examples from which to work, but they are by no means exhaustive in what you can do.
</p>
<p>
  The following link shows you the same folder of ODS converted to CSV files by the Ruby script, which is outlined below.
  This ZIP file is the one that you would upload to the Busme! Plan Compiler. It will give you an idea of the
  conversions to CSV files that must be performed to upload to our system.
</p>
<p>
  <a href="https://objects.dreamhost.com:443/busme-prod-files/examples/SyracuseUnivsersity-CSV.zip">SyracuseUniversity-CSV.zip</a>
</p>
<h3>We do not save your Busme! CSV Plan or Zip Files!</h3>
<p>
  You are solely responsible for maintaining your own plan data. We do <strong>not</strong> back up or store your data,
  other than what is needed maintain our internal representation of your submitted plan. And we only accept, or process CSV
  and KML files. We do not save or process XLS (MS Excel) or ODS (LibreOffice) files.
</p>
<h3>Generating CSV Files from ODS Files</h3>
<p>
  Saving your files in XLS or ODS format can be quite useful. It might have specific formatting such as
  different color or size fonts to help you read and navigate better.
  Also, you may use TIME(h,m,s) equations, which make it easier to enter in times in patterns, given that
  spreadsheet programs can distribute and increment column information across rows, and visa versa.
  In the end, we are only interested in the CSV files.
</p>
<p>
  In LibreOffice, StarOffice, and OpenOffice you may convert your ODS files to a CSV file using a the following
  command line:
  <pre>
  soffice --headless --convert-to csv path_to_odt_file --outdir dest_folder
  </pre>
  and be able to use it in scripts.
</p>
<p>
  NOTE: The special annoying trick with this command, when using it graphics environment on Linux at least,
  is that you cannot have an instance of Libreoffice running, Otherwise it just pops up a current LibreOffice window,
  and it does nothing else. It does not do the conversion.
  We find that we must close all our spreadsheets and quit LibreOffice altogether.
  Hopefully, somebody will make a fix for that.
</p>
<p>
  We present the following Ruby Script that will take a folder structure of a Busme! Plan and convert and copy all
  the ODS files to CSV files and include just them and the KML files.
</p>
<pre>
  #!/usr/bin/ruby
  require 'rubygems'
  require 'zip/zip'
  require 'find'
  require 'fileutils'

  class Zipper
    def self.zip(dir, zip_dir)
      Zip::ZipFile.open(zip_dir, Zip::ZipFile::CREATE)do |zipfile|
        Find.find(dir) do |path|
          Find.prune if File.basename(path)[0] == ?.
          dest = /#{dir}\/(\w.*)/.match(path)
          # Skip files if they exists
          begin
            zipfile.add(dest[1],path) if dest
          rescue Zip::ZipEntryExistsError
          end
        end
      end
    end
  end

  class Walker
    def self.walk(dir, destdir)
        Dir.open(dir).each do |filename|
            path = File.join(dir, filename)
            if File.directory?(path) && filename[0] != ?.
                dd = File.join(destdir, filename)
                FileUtils.mkdir_p(dd)
                puts "Into Directory #{dir} #{dd}"
                walk(path, dd)
            else
                case filename
                when /.*ods$/
                    system "echo soffice --headless --convert-to csv '#{path}' --outdir '#{destdir}'"
                    system "soffice --headless --convert-to csv '#{path}' --outdir '#{destdir}'"
                when /.*kml$/
                    system "echo cp '#{path}' '#{destdir}'"
                    system "cp '#{path}' '#{destdir}'"
                end
            end
        end
        nil
    end
  end

  def doit(dir, dest = ".")
    destdir = Dir.mktmpdir
    Walker.walk(dir, destdir)
    #FileUtil.rm_rf(destdir)   # uncomment if you want it to remove the intermediate directory
    Zipper.zip(destdir, File.join(dest, "#{File.basename(dir)}.zip"))
  end

  # Walk the given directory and place the resulting zip file in the specified directory or current directory..
  doit(ARGV[0], ARGV[1] || ".")
</pre>
